// Code generated by gen-flags DO NOT EDIT.
package cmd

import (
	"fmt"

	"github.com/spf13/cobra"

	"github.com/nottelabs/notte-cli/internal/api"
)

// VaultCredentialsAdd command flags
var (
	VaultCredentialsAddUrl string

	// Flattened: credentials object
	VaultCredentialsAddCredentialsEmail string
	VaultCredentialsAddCredentialsUsername string
	VaultCredentialsAddCredentialsPassword string
	VaultCredentialsAddCredentialsMfaSecret string

)

// RegisterVaultCredentialsAddFlags registers all flags for VaultCredentialsAdd command
func RegisterVaultCredentialsAddFlags(cmd *cobra.Command) {
	cmd.Flags().StringVar(&VaultCredentialsAddUrl, "url", "", "url")
	// credentials (flattened object)
	cmd.Flags().StringVar(&VaultCredentialsAddCredentialsEmail, "email", "", "email")
	cmd.Flags().StringVar(&VaultCredentialsAddCredentialsUsername, "username", "", "username")
	cmd.Flags().StringVar(&VaultCredentialsAddCredentialsPassword, "password", "", "password")
	cmd.Flags().StringVar(&VaultCredentialsAddCredentialsMfaSecret, "mfa-secret", "", "mfa-secret")
}

// BuildVaultCredentialsAddRequest builds the API request from CLI flags
func BuildVaultCredentialsAddRequest(cmd *cobra.Command) (*api.AddCredentialsRequest, error) {
	body := &api.AddCredentialsRequest{}

	if cmd.Flags().Changed("url") {
		if VaultCredentialsAddUrl == "" {
			return nil, fmt.Errorf("--url cannot be empty")
		}
		body.Url = VaultCredentialsAddUrl
	}

	// credentials (flattened) - only set if required fields are provided
	if VaultCredentialsAddCredentialsPassword != "" {
		body.Credentials = api.CredentialsDictInput{
			Email: &VaultCredentialsAddCredentialsEmail,
			Username: &VaultCredentialsAddCredentialsUsername,
			Password: VaultCredentialsAddCredentialsPassword,
			MfaSecret: &VaultCredentialsAddCredentialsMfaSecret,
		}
	}

	return body, nil
}
